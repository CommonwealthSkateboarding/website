@import com.feth.play.module.pa.views.html._
@(user: models.security.User = null)
@main("profile", false, "My Profile | Commonwealth Skateboarding | Portland, Oregon") {
<section id="profile">
    @if(user == null) {
        @* This condition occurs when not currently logged in *@
        <a href="/authenticate/facebook" class="btn"><i class="fa fa-facebook-square"></i> Sign in with Facebook</a><br/><br/>
        <a href="/authenticate/google" class="btn"><i class="fa fa-google-plus-square"></i> Sign in with Google</a>
    } else {
        @* This condition occurs when currently logged in *@
        <p class="h1">Profile</p>
        <h3>Welcome, @user.name</h3>

        <!--<p>
            <h3>My ID</h3>
            <img src="http://www.barcodes4.me/barcode/c39/@(user.publicId).png?IsReverseColor=1&isBorderDrawn=1"><br/>
            <code>@user.publicId</code>
        </p>-->

        @if((null == user.membership) && (0 == user.guardianOf.size)) {
            <!-- Message for unlinked users (no membership) -->
            <h3>Check-in at the park with your barcode and skate for free!</h3>
            <p>We'll link your online account with your membership and credit you with a free session pass.</p>
        }
        @if(null != user.membership) {
            <p>
                <h3>My Account:</h3>
                @* Gift certificate balance: @utils.Formatter.prettyDollars(user.membership.credit)<br/> *@
                @for(pass<-user.membership.getUnlimitedPassesForDisplay()) {
                    Unlimited pass: @pass.starts.format("MM/dd/yyyy") - @pass.expires.format("MM/dd/yyyy") @if(!pass.isValid()) { (expired) }<br/>
                }
                Saved passes: @user.membership.sessionPasses session, @user.membership.allDayPasses all-day<br/>
                Last visited:
                @if(null != user.membership.lastVisit) {
                    @user.membership.lastVisit.time.format("EEEE, M/dd/yyyy")
                } else {
                    <i>Never</i>
                }
            </p>
        }
        @if(user.guardianOf.size > 0) {
            <h3>My Kids</h3>
            @for(kid<-user.guardianOf) {
                <p>
                    @kid.name<br/>
                    @* Gift certificate balance: @utils.Formatter.prettyDollars(kid.credit)<br/>*@
                    @for(pass<-kid.getUnlimitedPassesForDisplay()) {
                        Unlimited pass: @pass.starts.format("MM/dd/yyyy") - @pass.expires.format("MM/dd/yyyy") @if(!pass.isValid()) { (expired) }<br/>
                    }
                    Saved passes: @kid.sessionPasses session, @kid.allDayPasses all-day<br/>
                    Last visited:
                    @if(null != kid.lastVisit) {
                        @kid.lastVisit.time.format("EEEE, M/dd/yyyy")
                    } else {
                        <i>Never</i>
                    }
                </p>
            }
        }
        <br/><br/>
        <a href="@com.feth.play.module.pa.controllers.routes.Authenticate.logout">Logout</a>
    }
</section>

}
